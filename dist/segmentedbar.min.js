var SegmentedBar={};!function(e,t,i){"use strict";i.namespaces={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",segview:" https://github.com/gspd-mobi/SegmentedBarView-Web"},i.createPaper=function(e,t){var n;return n=i.Svg.createElement("svg",{width:t.width,height:t.height,viewBox:t.viewBox}),e.appendChild(n),n}}(window,document,SegmentedBar),SegmentedBar.Svg=function(e,t,i){"use strict";function n(e,t,i,n,o,g,r){var c={x:t,y:i,rx:g,ry:g,width:n,height:o,style:"fill:"+r};return u("rect",c,e)}function o(e,t,i,n){var o={x:t,y:i,text:n.text,fill:n.color,style:"font-size:"+n.fontSize+"px;font-family: "+n.fontFamily+";"};return u("text",o,e)}function g(e,t,i,n,o,g){var r=o/2;t+=r,n-=r;var c=t+n,a=i+o,f="M "+t+" "+i+" L "+c+" "+i+" L "+c+" "+a+" L "+t+" "+a+" A 10 10 0 1 1 "+t+" "+i,l={d:f,fill:g};return u("path",l,e)}function r(e,t,i,n,o,g){n-=o/2;var r=t+n,c=i+o,a="M "+t+" "+i+" L "+r+" "+i+" L "+r+" "+c+" L "+t+" "+c+" M "+r+" "+c+" A 10 10 0 1 0 "+r+" "+i,f={d:a,fill:g};return u("path",f,e)}function c(e,t,i,n,o,g,r,c,s){var h=t-n/2,d=15,p=i-d;0>h&&(h=0),h+n>c&&(h=c-n);var v=a(t,i)+" "+f(t-d,p)+" "+f(h+g,p)+" "+l(g,g,0,0,1,h,p-g)+f(h,g)+" "+l(g,g,0,0,1,h+g,0)+" "+f(h+n-g,0)+l(g,g,0,0,1,h+n,g)+" "+f(h+n,p-g)+" "+l(g,g,0,0,1,h+n-g,p)+" "+f(t+d,p)+" "+f(t,i),x={d:v,fill:r};return{elem:u("path",x,e,s),x:h,y:0}}function a(e,t){return"M "+e+" "+t}function f(e,t){return"L "+e+" "+t}function l(e,t,i,n,o,g,r){return"A "+e+" "+t+" "+i+" "+n+" "+o+" "+g+" "+r}function s(e,t,i,n,o,g){var r=o/2;t+=r,n-=r;var c=t+n,a=i+o,f="M "+t+" "+i+" L "+c+" "+i+" L "+c+" "+a+" L "+t+" "+a+" L "+(t-r)+" "+(a-r)+" L "+t+" "+i,l={d:f,fill:g};return u("path",l,e)}function h(e,t,i,n,o,g){var r=o/2;n-=r;var c=t+n,a=i+o,f="M "+t+" "+i+" L "+c+" "+i+" L "+(c+r)+" "+(i+r)+" L "+c+" "+a+" L "+t+" "+a+" L "+t+" "+i,l={d:f,fill:g};return u("path",l,e)}function d(e,t,i,n,o,g){var r=o/2;n-=2*r,t+=r;var c=t+n,a=i+o,f="M "+t+" "+i+" L "+c+" "+i+" L "+(c+r)+" "+(i+r)+" L "+c+" "+a+" L "+t+" "+a+" L "+(t-r)+" "+(i+r)+" L "+t+" "+i,l={d:f,fill:g};return u("path",l,e)}function u(e,n,o,g){var r=t.createElementNS(i.namespaces.svg,e);if("svg"===e&&p(r,{"xmlns:segview":i.namespaces.segview}),"text"===e){var c=t.createTextNode(n.text);r.appendChild(c)}return n&&p(r,n),o&&(g?o.insertBefore(r,g):o.appendChild(r)),r}function p(e,t){Object.keys(t).forEach(function(i){e.setAttribute(i,t[i])})}return{createElement:u,setAttributes:p,drawRect:n,drawLabel:o,drawRoundedLeftRect:g,drawRoundedRightRect:r,drawAngleLeftRect:s,drawAngleRightRect:h,drawHexagon:d,drawBubble:c}}(window,document,SegmentedBar),function(e,t,i){"use strict";i.Bar=function(n,o){function g(){v()}function r(){if("rounded"===S.config.sideStyle){var e=S.config.segmentHeight*S.config.sideRadius/100;i.Svg.drawRect(S.paper,0,0,"100%",S.config.segmentHeight,e,S.config.emptySegmentColor)}"normal"===S.config.sideStyle&&i.Svg.drawRect(S.paper,0,0,"100%",S.config.segmentHeight,0,S.config.emptySegmentColor),"angle"===S.config.sideStyle&&i.Svg.drawHexagon(S.paper,0,0,S.config.viewBoxWidth,S.config.segmentHeight,S.config.emptySegmentColor);var t={text:S.config.emptySegmentText,color:S.config.emptySegmentTextColor,fontSize:S.config.textSize,fontFamily:S.config.textFont};l(t,0,0,S.config.viewBoxWidth,S.config.segmentHeight)}function c(e){var i=t.createElement("div");i.innerHTML=e;for(var n=i.childNodes,o=[],g=0;g<n.length;g++)o.push({text:n[g].textContent,superscript:"SUP"==n[g].tagName});return o}function a(e,t){var n=[S.config.value+(S.config.unit?"Â ":"")],o=c(S.config.unit||"");o.forEach(function(e){n.push(e.text||"")});var g,r,a=0,f=0,l=[],s=null;return n.forEach(function(n,c){s={text:n,fontSize:0==c?S.config.textSize:S.config.textSize/1.5,fontFamily:S.config.textFont,color:S.config.descriptionColor},r=i.Svg.drawLabel(S.paper,e,t,s),g=r.getBBox(),r.width=g.width,e+=g.width,a+=g.width,f<g.height&&(f=g.height),0!=c&&o[c-1].superscript&&(r.superscript=!0),l.push(r)}),{width:a,height:f,textNodes:l}}function f(e,t,n){var o=S.config.valueHeight,g=({text:S.config.value,fontSize:S.config.textSize,fontFamily:S.config.textFont,color:S.config.descriptionColor},a(e,t)),r=1.5*g.width;if(n){var c=(i.Svg.drawBubble(S.paper,e,t,r,o,15,S.config.bubbleColor,S.config.viewBoxWidth,g.textNodes[0]),null);e-=g.width/2,t=(o-15)/2+g.height/2-S.config.textSize/3,g.textNodes.forEach(function(n){c={x:e,y:n.superscript?t-S.config.textSize/2.5:t},i.Svg.setAttributes(n,c),e+=n.width})}S.bubbleRendereded=!0}function l(e,t,n,o,g){var r=i.Svg.drawLabel(S.paper,t,n,e),c=r.getBBox(),a=S.config.textSize,f=t+(o-c.width)/2,l=n+(g+c.height)/2-a/3;console.log("BBox :"+c.width+" "+c.height),console.log(f+" "+l),i.Svg.setAttributes(r,{x:f,y:l})}function s(e){return e.descriptionText?e.descriptionText:"first"==e.position?"<"+e.minValue:"last"==e.position?">"+e.maxValue:e.minValue+"-"+e.maxValue}function h(e){var t=s(e),i={text:t,fontSize:S.config.textSize,fontFamily:S.config.textFont,color:S.config.descriptionColor};l(i,e.x,e.y,e.length,e.height)}function d(e){"normal"==e.sideStyle&&i.Svg.drawRect(S.paper,e.x,e.y,e.length,S.config.segmentHeight,0,e.color),"rounded"===e.sideStyle&&("first"===e.position?i.Svg.drawRoundedLeftRect(S.paper,e.x,e.y,e.length,S.config.segmentHeight,e.color):"last"==e.position?i.Svg.drawRoundedRightRect(S.paper,e.x,e.y,e.length,S.config.segmentHeight,e.color):"single"==e.position?i.Svg.drawRect(S.paper,e.x,e.y,e.length,S.config.segmentHeight,S.config.segmentHeight/2,e.color):i.Svg.drawRect(S.paper,e.x,e.y,e.length,S.config.segmentHeight,0,e.color)),"angle"===e.sideStyle&&("first"===e.position?i.Svg.drawAngleLeftRect(S.paper,e.x,e.y,e.length,S.config.segmentHeight,e.color):"last"===e.position?i.Svg.drawAngleRightRect(S.paper,e.x,e.y,e.length,S.config.segmentHeight,e.color):"single"===e.position?i.Svg.drawHexagon(S.paper,e.x,e.y,e.length,S.config.segmentHeight,e.color):i.Svg.drawRect(S.paper,e.x,e.y,e.length,S.config.segmentHeight,0,e.color)),h(e);var t=S.config.value;t&&S.config.showValue&&!S.bubbleRendereded&&(e.minValue<t&&e.maxValue>t?f(u(e),e.y,!0):(e.minValue===t&&e.includeLeft||e.maxValue===t&&e.includeRight)&&f(u(e),e.y,!0))}function u(e){var t=(S.config.value-e.minValue)*e.length/(e.maxValue-e.minValue)+e.x,i=e.height/2;return("first"===e.position||"single"===e.position)&&i>t&&(t=i+1),("last"===e.position||"single"===e.position)&&t>=S.config.viewBoxWidth-i&&(t=S.config.viewBoxWidth-i-1),t}function p(){var e=S.config.showValue&&S.config.value&&S.config.valueHeight?S.config.valueHeight:0,t=0,i=S.config.segments.length,n=(S.config.viewBoxWidth-(i-1)*S.config.gap)/i,o=null;S.config.valueHeight>0&&S.showValue&&(e=S.config.valueHeight);for(var g=0;i>g;g++)o=S.config.segments[g],o.x=t,o.y=e,o.length=n,o.sideStyle=S.config.sideStyle,o.height=S.config.segmentHeight,1==i?o.position="single":(0==g&&(o.position="first"),g==i-1&&(o.position="last")),d(o),t+=n+S.config.gap;S.config.showValue&&S.config.value&&!S.bubbleRendereded&&f(S.config.viewBoxWidth/2,0,!1)}function v(){S.paper&&S.container.removeChild(S.paper),x(),m(),S.paper=i.createPaper(n,{width:S.width,height:S.height,viewBox:"0 0 "+S.config.viewBoxWidth+" "+S.config.viewBoxHeight}),i.Svg.drawRect(S.paper,0,0,"100%","100%",0,S.config.backgroundColor),S.config.segments&&0!==S.config.segments.length?p():r()}function x(){Object.keys(S.defaultConfig).forEach(function(e){S.config[e]||(S.config[e]=S.defaultConfig[e])}),S.config.showValue&&0!==S.config.segments.length&&S.config.value||(S.config.valueHeight=0),console.log(S.config),w()}function m(){S.width=S.container.offsetWidth,S.height=S.width*S.config.viewBoxHeight/S.config.viewBoxWidth}function w(){S.config.viewBoxHeight=S.config.segmentHeight,S.config.showValue&&(S.config.viewBoxHeight+=S.config.valueHeight)}var S=this;return this.container=n,this.config=o,this.bubbleRendereded=!1,this.defaultConfig={emptySegmentText:"No data",emptySegmentTextColor:"#FFF",emptySegmentColor:"#858585",gap:10,textSize:35,textFont:"Calibri, verdana, tahoma",sideStyle:"angle",sideRadius:50,showValue:!1,value:144,unit:"mmol<sup>2</sup>/L",segmentHeight:80,valueHeight:100,bubbleColor:"#7492E2",backgroundColor:"#FFF",viewBoxHeight:100,viewBoxWidth:1e3,descriptionSize:40,descriptionColor:"#FFF",segments:[]},v(),this.resizeListener=e.addEventListener("resize",function(){S.bubbleRendereded=!1,g()}),this}}(window,document,SegmentedBar);